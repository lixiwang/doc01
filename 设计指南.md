# 设计指南

[TOC]

## 概述

 ##设计约定

> 约定。

为了实现产品可迭代性，提高平台构建效率，在设计方法及手段等方面，采纳一些被普遍认为的最佳实践。

### 为什么需要设计指南？

过去几年里，产品的设计方式发生了重大变化。随着低代码平台和 AI 自动编程的出现，对敏捷产品开发的需求从未如此强烈。

**复杂性**
大量应用系统、海量代码和组件积累，多样化的技术生态多彩纷呈。这些知识积累。应用的设计开发，系统性更加复杂。

> 大家知道，基因决定了生命的形态，那么，又是什么主宰了基因？

### 指南内容

设计指南从写作风格指南、设计原则、设计方法与设计范式等四个方面，指导你规范、高效的进行复杂系统设计。

**写作风格指南**
写作风格指南提供了编写简洁、具体的相关开发文档的技术写作指南。这些准则可确保技术作者创建对话式、尊重性且友好的内容，而无需使用行话[^googledoc]。指南中的格式规范可以确保文档可被人类阅读和编辑的同时，也便于机器或 AI 进行处理。

风格指南参考了世界领先企业的相关指南。包括：

- Google 开发者风格指南
- 微软写作风格指南
- Apple 风格指南

写作能力是一个循序渐进的过程。你可以参考[「如何做好技术文档」](./refs/如何做好技术文档.md)、[「写作即思考」](./refs/写作即思考.md)，学习如何全面提升技术文档能力。

[^googledoc]: Google 开发者风格指南

**设计原则**
统一设计原则，。

**设计范式**
设计范式可以极大的提高设计成熟度和沟通效率。

### 如何使用

能够指导系统建设者完成建模设计过程并回答他们的问题，例如：「如何组织模型？」、「建模工作流程是什么？」、「在该工作流程的每个步骤中应该生成哪些模型要素？」、「这些要素如何链接在一起？」等。

## 技术文档风格指南

### 文档格式

设计文档采用 `Markdown + git` 方案：

- 采用 Markdown 格式编辑文档
- 使用 git 及 github，进行版本控制及多人共创
- Markdown 排版格式约定

### 编辑器

使用 Microsoft Visual Code，并安装以下必要插件：

- Markdown All in One
- Markdown Preview Enhanced

开发、调试与管理相关的插件，根据技术栈进行安装。

### 写作风格指南

> 风格指南有助于保持文档整体风格的统一，给用户呈现一个一致的形象。

多人协作时，如果每个人都有自己的风格，都按各自的表达和用词习惯来，那么最终的内容成品就很可能会风格不一，看起来不像为一个产品写的文档，还可能会给用户造成困惑。

## 设计原则

新一代软件系统的设计，采用以下根本性原则：

- 系统性
- 分层
- 开放系统
- 简单规则
- 涌现

为了更好的理解设计原则，下面进行逐一解释。

### 系统性

> **整体大于部分之和** —— 亚里士多德（公元前384—322）

#### 系统论

在当今复杂世界（如全球化经济、互联网生态、气候变化）中，绝大多数问题都是「复杂系统问题」，还原论已无法应对，这是系统论越来越重要的核心原因。

系统论是 20 世纪中期兴起的一门跨学科方法论，其核心是将研究对象视为一个「系统」—— 即由相互关联、相互作用的若干部分（要素）组成，具有特定结构和功能的有机整体，并通过分析系统的结构、功能、动态变化及与外部环境的关系，揭示事物运行的规律。

#### 还原论与整体论

「还原论」强调将复杂系统分解为更简单的组成部分来理解，假设通过理解各个部分及其基本规律，就能理解整个系统。所以，「还原论」强调分析、分类和简化。

「整体论」打破了传统「还原论」（将整体拆分为孤立部分研究）的局限，强调系统作为一个整体的特性和行为，认为整体具有其局部所不具备的新特性。而且，这些特性源于各局部之间的相互作用。已广泛应用于自然科学、社会科学、工程技术、管理学等多个领域。

举例说明：
> 若一台电脑无法开机 ——
> 还原论思维：逐一检查硬件（电源、主板、CPU），找到损坏的零件更换；
> 整体论思维：除了检查硬件，还会考虑 “硬件间的兼容性”（如新主板与旧 CPU 不匹配）、“软件系统”（如系统崩溃导致无法启动）、“外部环境”（如电压不稳损坏硬件），避免 “只换零件却忽略关联问题”。

#### 核心概念

要理解系统论，需先掌握其几个核心概念和不可动摇的基本原则，这些是分析所有系统的通用语言。

- **系统（System）**：由两个及以上相互关联的要素组成，具有明确边界和特定功能的有机整体。
- **要素（Element）**：系统的基本组成单位，是系统功能的承载者。要素本身也可能是一个子系统。
- **结构（Structure）**：系统内要素之间的关联方式（如顺序、层级、数量比例等）。结构决定功能 —— 同样的要素，结构不同，系统功能可能完全不同。
- **功能（Function）**：系统在外部环境中所发挥的作用或达成的目标，是系统存在的意义。功能由结构决定，但也受外部环境影响。
- **环境（Environment）**：系统之外与系统存在物质、能量、信息交换的所有事物的总和。任何系统都不是孤立的，而是「开放系统」。
- **反馈（Feedback）**：系统输出的信息反过来影响系统输入，从而调节系统行为的过程，是系统维持稳定或实现目标的关键机制。

#### 基本原则

这是系统思维分析问题的底层逻辑，也是区别于传统思维的核心特征：

- **整体性原则**：「整体大于部分之和」（贝塔朗菲核心观点）。研究系统时不能孤立分析要素，而要关注要素间的关联。
- **层次性原则**：系统具有「层级结构」—— 大系统包含子系统，子系统又包含更低层级的要素，不同层级的系统既有相对独立性，又相互关联。
- **动态性原则**：系统不是静止的，而是处于持续的「动态变化」 中，通过与环境的物质、能量、信息交换，以及内部要素的相互作用，不断调整结构和功能，实现「动态平衡」。
- **开放性原则**：除极少数理想状态的「封闭系统」（如孤立的热力学系统），现实中的系统都是「开放系统」，必须与环境进行交换才能维持存在（若切断交换，系统会逐渐瓦解）。
- **目的性原则**：复杂系统（尤其是人造系统、生物系统）通常具有明确的目标，系统的结构和行为会围绕目标调整，通过反馈机制不断修正偏差，直至达成目标。

#### 避免误区

应用整体论进行系统建模时，需要避免一些误区。

- **拒绝局部视角**：明确建模核心目标，系统建模时优先考虑整体功能，而非单个要素的效率（如不能为了 “降低物流成本” 而牺牲 “配送时效”，导致系统整体满意度下降），不同目的决定建模精度；

- **拒绝边界模糊**：明确系统的范围，避免环境因素与内部要素混淆，降低建模复杂度。

- **拒绝过度覆盖**：要素抽象时，提炼核心要素，忽略无关细节；明确建模核心约束，避免过度追求全要素覆盖。比如小团队建模社区物流系统，可暂不考虑极端天气对配送的影响（低概率约束），优先保障核心逻辑闭环。

- **拒绝静态视角**：模型需体现系统的动态演化，必须包含「输入 — 处理 — 输出 — 反馈」的闭环。

### 分层

> 分层理论为我们提供了一把解开复杂系统奥秘的钥匙。

#### 分层理论

面对复杂系统时，不应试图一次性理解其全部，而应先去识别它的层次结构，理解各层的功能以及层间如何交互，从而更有效地预测、控制和优化系统行为。

在复杂系统中，分层理论是一种核心的分析与建模范式。许多复杂系统并非混沌一团，而是由多个相对独立又相互联系的层次组织而成。理解这种层次结构是理解系统整体行为、稳定性和演化的关键。

#### 核心观点

- **层级结构是普遍存在的：**
  从生物体（细胞-组织-器官-个体）、社会组织（个人-家庭-社区-国家），到计算机网络（物理层-数据链路层-网络层-传输层等），自然界和人类构建的复杂系统普遍呈现出层次化的组织方式。
- **层次是功能模块：**
  每一层都是一个具有特定功能的子系统。它将内部细节封装起来，只通过明确的接口与上下层进行交互。这种模块化极大地降低了理解和处理系统的复杂度。
- **层次间存在相互作用：**
  下层为上层提供基础和支持，上层对下层进行协调和控制。这种相互作用常常是非线性的，即微小的下层变动可能引发上层巨大的、难以预测的变化（涌现现象）。
- **层次结构提升系统鲁棒性与演化速度：**
  - 鲁棒性：系统的某一层次（特别是底层）发生局部故障时，其影响可以被限制在该层次或局部范围内，而不至于导致整个系统崩溃。例如，在分层网络中，优化结构和实现跨层协同可以显著提高整体网络的容错能力。
  - 演化优势：如果存在稳定的中间形式（即层次），复杂系统从简单系统演化而来的过程会快得多。这使得层级结构成为复杂系统最可行的组织形式。

#### 关键作用与体现

- **管理复杂性**：通过将系统分解为多个层次，分层理论实现了关注点分离。研究人员或工程师可以专注于某一层的设计和优化，而不必同时应对所有细节。
- **实现涌现**：许多系统整体的、宏观的智能或模式（如鸟群的飞行、意识的产生），并不能归因于某个特定层次，而是不同层次组件之间非线性相互作用的结果。
- **提供分析与设计框架**：该理论为我们提供了分析和设计复杂系统的清晰方法论。
- **识别层次结构**：可以通过观察系统行为的时间尺度、分析组件的模块性、以及探索潜在的因果关系等方法来实现。
- **指导系统优化**：理解层次结构有助于找到系统的脆弱点和杠杆点。例如，在分层复杂网络中，逻辑层（负责信息交换）的安全性往往对整体网络的鲁棒性具有决定性影响。

#### 在不同领域的实例

- **计算机科学**：网络协议的分层模型（如TCP/IP协议栈）和软件架构的分层设计（如MVC模式）都是该理论的直接应用，它们通过定义清晰的层间接口，保证了系统的灵活性和可维护性。
- **生物系统**：生物系统本身就是分层理论的完美体现，从分子、细胞器、细胞、组织到器官和个体，每一层都构建在下一层之上。
- **系统工程**：在自动驾驶、机器人等领域，分层规划将高级目标逐步分解为具体的底层动作，有效应对了决策空间的爆炸问题。
- **数据仓库**：数据通常被分为数据操作层、数据仓库层和数据集市层等，通过分层管理来保证数据质量、简化业务逻辑和提高查询效率。

### 开放

> 任何系统都不是孤立存在的，而是通过与外部环境持续交换物质、能量和信息来维持自身稳定、实现发展演化的有机整体。

有开放系统与开放式系统，两种理解。
在这里，充分考虑了这两种意义。

#### 开放系统

开放系统指能与外界环境进行物质、能量或信息交换的系统，其边界明确区分系统内部与外部环境。

实际上，现实中大多数系统（如生态系统、经济系统）均为开放系统，封闭系统仅在特定条件下（如短时间或小范围）近似成立。 ‌

- **核心特征与原理**
  - 环境互动性
  - 动态平衡性
  - 反馈调节机制
  - 层次结构性
  - 演化与适应性

#### 开放式系统

> 在计算机领域，开放式系统(Open System)指的是一种遵循公开标准、支持互操作性、可扩展性和可移植性的软硬件架构。

这类系统的设计目标是打破封闭生态的壁垒，允许不同厂商的组协同工作，避免被单一供应商锁定（Vendor Lock-in）。

- 开放标准（Open Standards）
- 互操作性（Interoperability）
- 可移植性（Portability）
- 模块化与扩展性（Extensibility）
- 开源（Open Source，可选但常见）

#### OpenAPI



### 简单规则

> 简单规则，通过组合、排列、演化，构建出无限复杂的世界。

![菜花和西蓝花的分形特征](image-1.png)

简单规则，展现出惊人的简单之美。

#### 构建复杂世界的核心逻辑

**基础单元极简**：复杂系统的底层都是简单、统一的「积木」，没有多余的复杂初始设计。

**规则统一且稳定**：基础单元遵循相同的互动规则（如连接方式、运动规律），无需额外调整。

**层级叠加生复杂**：简单单元通过重复、组合、嵌套形成层级，层级间的互动催生出新的功能和形态。

#### 简单规则的核心价值

- 高效且稳定
  单一结构减少冗余，系统出错率低，修复和迭代更便捷。
- 可复制易扩展
  基础单元和规则可重复使用，能快速扩展系统规模（如细胞分裂让生物体生长，笔画组合让语言不断丰富）。
- 逻辑清晰易理解
  底层简单意味着本质可追溯，无需复杂拆解就能把握核心规律。

为了更好理解「简单与复杂」，您先来看两个稀松平常却无比惊叹的实例。

**自然世界**：原子（单一基础单元）通过不同化学键组合，形成千万种物质；细胞（生命基本单元）分化、协作，构成复杂的生物体；结缔组织的「细胞 + 间质」基本结构，演化出骨骼、血液、脂肪等多样形态，支撑起人体。

**人造世界**：二进制代码（ 0 和 1 ）组合出复杂的软件、互联网；乐高积木（统一接口的模块）能拼搭出建筑、机械等无数造型；汉字的「笔画」（基础单元）通过不同排列，形成数万汉字，承载丰富语言体系。

### 拓扑？

拓扑学，特别是代数拓扑和微分拓扑的工具，将被用来对量子网络进行分类，并推导其涌现出的宏观物理定律。

系统功能由 “要素 + 结构” 共同决定，相同要素因结构不同可产生不同功能，不同要素通过合理结构组合可实现相似功能。

- 拓扑定义了网络的整体连接结构。
- 量子定义了网络中基元的状态和动力学。
- 信息定义了什么是实在的基本本体。

底层网络如何连接（其拓扑结构）将直接决定涌现时空的整体拓扑。

## 设计方法论

设计方法论包括 OPM 对象过程方法与 MagicGrid 建模方法。

- OPM
- MagicGrid

### OPM

### MagicGrid

MagicGrid方法是NoMagic公司(被达索收购)通过总结众多MBSE项目经验形成的，可修改或扩展以支持特定客户需求的最佳实践建模方法。

## 设计范式

支持人类编程与 AI 编程的协同。

- 约定优于配置
- API 优先
- 配置驱动架构
- 服务架构
- 消息驱动

### 约定优于配置

> 约定优于配置（Convention over Configuration），又称 **按约定编程**，是一种通过预设开发约定减少配置数量的软件设计范式。其核心在于开发者只需定义偏离约定的部分。[^COC]

[^COC]: [百度百科 — 约定优于配置](https://baike.baidu.com/item/%E7%BA%A6%E5%AE%9A%E4%BC%98%E4%BA%8E%E9%85%8D%E7%BD%AE)

设计不好的框架通常包含多个配置文件，且每一个配置文件都有太多参数，这是复杂系统过度设计的指标。

我们采用约定优于配置

**零配置运行**
遵循约定的情况下，配置不是必需的，总是可以采用默认配置正确运行。

**零配置交互**
同样，两个或更多的应用之间，不需要工程配置，总是可以顺利的实现交互。

### API 优先

-对系统设计的建议：

> 设计初期明确系统核心目标，避免以单一模块功能最优为导向
> 绘制「目标 —— 模块映射」，确保无功能冗余或目标偏离模块
> 方案评审时优先验证「整体目标达成度」，再优化模块细节
>

## 其他

### 复杂系统

#### 概念

复杂系统是系统论的子集，研究由大量相互作用的要素（子系统）组成的系统，其整体行为无法通过简单叠加部件特性来预测。

典型特征包括非线性动力学、混沌行为（如蝴蝶效应）和涌现现象。例如，洛伦兹系统的微小初始条件变化会导致截然不同的结果，这使得建模需优先捕捉复杂性而非简化。

复杂系统是由大量相互作用的要素（子系统）构成，通过要素间 **非线性互动** 涌现出整体功能与结构，且与环境持续交换物质、能量、信息的动态有机整体，无法通过拆解单个要素来完全解释整体行为。

关键概念：

- 复杂性
- 网络
- 非线性
- 层级嵌套
- 涌现
- 适应
- 动态演化

#### 涌现

涌现（Emergence）是复杂系统科学领域的一个核心概念，它揭示了系统整体性质与其组成部分之间关系的深刻奥秘。

涌现现象在自然界中屡见不鲜：从雪花的形状到星系的形成，都显示出一种「整体大于部分之和」的规律。人们不禁会问：大模型的涌现能力，是否也暗合了某种宇宙间更深层次的规律？

![蜂群的能力涌现](image.png)

简单局部规则通过非线性交互与规模累积，在临界状态下自组织涌现出系统级的全新整体属性。

协同与涌现是复杂系统中两种核心现象，分别描述系统组成部分通过相互作用产生新特性或能力的过程。

#### 自组织

自组织理论是研究复杂自组织系统形成机制的跨学科理论，主要揭示系统如何从无序自发演化为有序结构的过程。

自组织：复杂系统的 “自主有序化” 机制

自组织是指复杂系统中的要素，在无外部统一指令的情况下，通过相互作用、协同配合，自发形成有序结构或功能模式的过程。

自组织的核心特征如下：

- **无外部指令**：无需顶层强制安排，依赖要素间的局部互动。
- **从无序到有序**：系统初始状态可能混乱，通过互动逐渐形成规则结构。
- **动态适应性**：结构会随环境变化自主调整，而非固定不变。

**自组织系统**（self—organizing system）
一种高级的有组织系统。它不需外力的干预，能自行建立秩序，提高有序度，从一种组织状态内另一种组织状态转变。

自组织系统本身是个不稳定的或亚稳定的系统，它通过一个组织核心，根据系统内部各元素或组成部分相互作用所产生的一条自动之择链，而产生一种不可逆的组织过程。

> 生命起源，物种进化、人类思维、社会组织等复杂系统中都存在自组织过程。

**自组织核心**
自组织核心最初可能是随机形成的，它的微小差别可以导致最后形成大组织后出现巨大差别，物种发展就有此情况。自组织核心也可以是人为的，故它可以成为人类建立所需组织系统的一种途径。

**自繁殖系统**
自组织系统的高级形式是可以实现「自再生」和「自繁殖」的系统，这些系统不仅能在要素数量已定的情况下改变其结构，而且还能用新的要素替换旧的要素，从而实现「再生」，如果此过程同系统在要素数量上的增长相结合，那就是自繁殖系统。

自组织系统举例：

- 自然系统：蚂蚁群无需 “指挥官”，通过信息素互动自发形成觅食路径；雪花的冰晶在降温过程中，水分子自发排列成对称有序的六角结构。
- 社会系统：城市中的商业街，无需规划部门强制安排，商户会自发聚集形成特色商圈；网络社群中，用户自发形成讨论规则、分工模式（如论坛版主、志愿者）。
- 技术系统：神经网络通过数据训练，神经元之间自发调整连接强度，形成识别特定模式的能力；区块链节点通过共识机制，自发同步数据、维护账本秩序。

#### 自相似

自相似：复杂系统的 “跨尺度重复” 结构

自相似是指复杂系统的整体结构，与局部（子系统）结构在形态、规律上具有相似性，即 “部分与整体像”，且这种相似性可跨不同尺度存在（也叫 “分形特征”）。**分形（Fractal）**：揭示了自然、社会和思维中的自相似现象。

> **分形几何** 提供了一种全新的视角来观察和理解我们周围复杂、不规则的世界。它揭示了隐藏在混乱表象下的有序结构——尺度不变性和自相似性。
> **分形理论** 是基于分形几何学的数学基础，主要用于描述和研究客观事物的复杂性。它的基本特点是用分数维度的视角来分析事物，超越传统的一维、二维和三维的限制，更加符合自然界的多样性与复杂性。

核心特征：

- **跨尺度一致性**：从微观到宏观，结构或规律重复出现（如树叶的叶脉与整棵树的分枝、河流的支流与干流）。
- **局部映射整体**：通过观察单个局部，可推测整体的大致结构。
- **非严格复制**：「近似相似」而非完全相同，保留局部差异（如雪花虽都是六角形，但没有两片完全一样）。

自相似结构举例：

- 自然系统：海岸线的局部曲线与整体海岸线形态相似，放大任何一段都能看到类似的曲折；蕨类植物的叶片，每一片小叶的形状都和整片复叶相似。
- 社会系统：企业的部门架构（如分公司 - 子部门 - 小组）与整个公司的组织架构相似；城市的交通网络（社区道路 - 主干道 - 高速路）与国家交通网络的层级结构相似。
- 技术系统：互联网的拓扑结构，局部节点的连接模式与整个网络的连接模式相似；软件的模块化设计，子模块的功能逻辑与整体系统的逻辑框架相似。

#### 大语言模型

尚未找到确凿证据证明大模型的涌现能力与宇宙基本法则直接相关。现有的解释主要依赖于非线性系统中的临界现象和复杂性理论。

涌现更多地反映了当系统达到一定规模后，局部相互作用累积到一定程度时，自然会出现全新行为的必然性，而不一定意味着它与宇宙中其他现象有着直接的联系。

通常采用深度神经网络结构，如循环神经网络（RNN）、变种LSTM或Transformer。这些模型具有多层的结构，可以自动地学习和捕捉输入数据中的复杂模式和关联关系。在这种多层关系中，时常会得到意料之外的结果，这是最常出现涌现的地方。

### 排版格式约定

> 统一中文文案、排版的相关用法，降低团队成员之间的沟通成本，增强网站气质。[^pb]

[^pb]: [中文文案排版指北](https://github.com/sparanoid/chinese-copywriting-guidelines)

#### 空格

- 中英文之间需要增加空格
- 中文与数字之间需要增加空格
- 数字与位之间需要增加空格
- 全角标点与其他字符之间不加空格
- 链接之间增加空格

#### 全角和半角

- 使用全形中文标点
- 数字使用半形字符
- 遇到完整的英文整句、特殊名詞，其內容使用半形标点
- 专有名词使用正确的大小写
- 简体中文使用直角「引号」

### 开发环境问题

> 工欲善其事必先利其器。 —— 孔子 《论语》

出于审查或广告推广等原因，开发环境所依赖的部分资源或服务，可能出现网络不稳定或不可达。这会极大影响工作效率。建议通过技术手段解决，而不是忍受。可参考 [开发环境常见问题](./refs/FAQ.md) 进行配置。
